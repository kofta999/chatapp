<!DOCTYPE html>
<html>
  <head>
    <title>Create Chat</title>
    <script src="utils.js"></script>
  </head>
  <body>
    <h1>Create New Chat</h1>
    <form
      id="createChatForm"
      action="https://example.com/create-chat"
      method="POST"
    >
      <label for="name">Name:</label>
      <input type="text" id="name" name="name" required /><br />

      <label for="isGroupChat">Is Group Chat:</label>
      <input type="checkbox" id="isGroupChat" name="isGroupChat" /><br />

      <label for="participants">Participants:</label>
      <input type="text" id="participants" name="participants" required /><br />

      <input type="submit" value="Create Chat" />
    </form>

    <script>
      document
        .getElementById("createChatForm")
        .addEventListener("submit", function (event) {
          event.preventDefault(); // Prevent form submission

          // Get the participants as an array
          const participantsInput = document.getElementById("participants");
          const participants = participantsInput.value
            .split(",")
            .map((participant) => participant.trim());

          // Create a FormData object
          // const formData = new FormData();
          // formData.append("name", document.getElementById("name").value);
          // formData.append(
          //   "isGroupChat",
          //   document.getElementById("isGroupChat").checked
          // );
          // formData.append("participants", JSON.stringify(participants));

          // Send the form data to the server
          console.log(document.getElementById("name").value);
          sendAuthenticatedRequest("http://localhost:3000/chats", "POST", {
            name: document.getElementById("name").value,
            isGroupChat: document.getElementById("isGroupChat").checked,
            participants: JSON.stringify(participants),
          })
            .then((response) => {
              // Handle the response
              console.log("Chat created successfully!");
              // Redirect to the desired page
              window.location.href = "index.html";
            })
            .catch((error) => console.error("Error:", error));
        });
    </script>
  </body>
</html>
